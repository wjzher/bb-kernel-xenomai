From a0ed312190125d6d0594443ba028ae131e545481 Mon Sep 17 00:00:00 2001
From: efargas <efargas@users.noreply.github.com>
Date: Tue, 15 Sep 2015 21:04:42 +0200
Subject: [PATCH 12/12] PWM period control

Applied patch from https://github.com/avterekhov/bb-pwm/ testes and workin on 3.8.13 branch
---
 drivers/pwm/pwm_test.c | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)

diff --git a/drivers/pwm/pwm_test.c b/drivers/pwm/pwm_test.c
index 9c07880..7b50052 100644
--- a/drivers/pwm/pwm_test.c
+++ b/drivers/pwm/pwm_test.c
@@ -41,7 +41,7 @@ static ssize_t pwm_test_show_duty(struct device *dev,
 		struct device_attribute *attr, char *buf)
 {
 	struct pwm_test *pwm_test = dev_get_drvdata(dev);
-
+	pwm_test->duty = pwm_test->pwm->duty;
 	return sprintf(buf, "%d\n", pwm_test->duty);
 }
 
@@ -65,7 +65,7 @@ static ssize_t pwm_test_store_duty(struct device *dev,
 		return rc;
 	}
 
-	pwm_test->duty = duty;
+	pwm_test->duty = pwm_test->pwm->duty;
 
 	return count;
 }
@@ -74,7 +74,7 @@ static ssize_t pwm_test_show_period(struct device *dev,
 		struct device_attribute *attr, char *buf)
 {
 	struct pwm_test *pwm_test = dev_get_drvdata(dev);
-
+	pwm_test->period = pwm_test->pwm->period;
 	return sprintf(buf, "%d\n", pwm_test->period);
 }
 
@@ -102,7 +102,7 @@ static ssize_t pwm_test_store_period(struct device *dev,
 		return rc;
 	}
 
-	pwm_test->period = period;
+	pwm_test->period = pwm_test->pwm->period;
 
 	return count;
 }
-- 
2.5.1

